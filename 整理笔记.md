# 整理笔记

1.  Eventloop
	Reactor模式下最核心的是事件分发机制，整个框架最基本的一个模块就是Eventloop，Eventloop控制着该IO线程的事件分发。

	1. 1 Eventloop在大部分时候都循环在Eventloop::loop()循环里面监听它的每一个文件描述符(fd)，每一个fd由不同的Channel负责，而IO multiplexing由Eventloop持有的Poller成员负责。

	1. 2 Eventloop数据成员里包含一个wakeupFd，它是一个eventfd可以用来完成线程间通信，因为IO线程平时阻塞在Eventloop::loop()循环里，为了IO线程能够立即执行用户回调，用eventfd来唤醒它。在Eventloop构造函数初始化的时候enableReading()。
	
	eg: 以前唤醒线程是通过建立一个管道pipe，IO始终监视这个pipe，需要唤醒的时候其他线程往pipe里写入一个字节。现在有了eventfd之后可以更加高效的唤醒，不用管理缓冲区。

2.  TimerQueue定时器

	TimerQueue定时器是为了给Eventloop的回调函数runInLoop加上定时功能而存在的，这个模块主要由三个class实现（TimerId、Timer、TimerQueue）。
	
	2. 1 Timer Class是定时器最基础的一个模块，它包含了定时器所需要的数据成员（回调函数、过期时间、间隔时间，序列号等等）。
	
	eg： 每一个Timer的序列号sequence都是由静态数据成员s_numCreated通过原子操作递增而来。
	
	2. 2 TimerId Class简单封装了Timer Class数据成员包含一个Timer Class和自己的序列号。
	2. 3 TimerQueue Class